{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}
{% set title = title ?? "Metapilot Settings" %}

{% block content %}
<form method="post" accept-charset="UTF-8">
  {{ csrfInput() }}
  {{ actionInput('plugins/save-plugin-settings') }}
  {{ hiddenInput('pluginHandle', 'metapilot') }}

  {{ forms.autosuggestField({
    label: "OpenAI API Key"|t,
    id: 'openAiApiKey',
    name: 'settings[openAiApiKey]',
    value: settings.openAiApiKey,
    suggestEnvVars: true,
    placeholder: 'METAPILOT_OPENAI_API_KEY',
    instructions: 'Enter your OpenAI API key to enable AI-powered meta content generation.'
  }) }}

  {{ forms.selectField({
    label: "OpenAI Model"|t,
    id: 'openAiModel',
    name: 'settings[openAiModel]',
    value: settings.openAiModel ?? 'gpt-4o-mini',
    options: [
      {label: 'GPT-4o Mini (Recommended)', value: 'gpt-4o-mini'},
      {label: 'GPT-4o', value: 'gpt-4o'},
      {label: 'GPT-3.5 Turbo', value: 'gpt-3.5-turbo'}
    ],
    instructions: 'Choose the OpenAI model to use for content generation.'
  }) }}

  {{ forms.lightswitchField({
    label: "Overwrite existing values"|t,
    id: 'overwriteExisting',
    name: 'settings[overwriteExisting]',
    on: settings.overwriteExisting,
    instructions: 'If enabled, Metapilot will replace existing meta descriptions and keywords.'
  }) }}

  <div class="buttons">
    <button type="submit" class="btn submit">Save settings</button>
  </div>
</form>
{% endblock %}